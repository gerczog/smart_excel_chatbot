<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ Excel Smart Chatbot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 1000px;
            height: 80vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .status {
            font-size: 14px;
            opacity: 0.9;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
            padding: 20px;
            overflow-y: auto;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #fafafa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message.bot .message-content {
            background: white;
            border: 1px solid #e9ecef;
            color: #333;
        }

        .message-time {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        .chat-input {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s;
        }

        .chat-input input:focus {
            border-color: #667eea;
        }

        .send-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s;
        }

        .send-btn:hover {
            transform: translateY(-2px);
        }

        .send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .file-info {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .file-info h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .file-info p {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .regions-list {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .regions-list h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .region-item {
            background: #f8f9fa;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
        }

        .examples {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .examples h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .example-item {
            background: #f8f9fa;
            padding: 10px;
            margin: 8px 0;
            border-radius: 6px;
            font-size: 13px;
            color: #333;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .example-item:hover {
            background: #e9ecef;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
        }
        
        .file-upload {
            margin-top: 15px;
        }
        
        .file-input {
            margin-bottom: 10px;
            width: 100%;
        }
        
        .upload-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s;
            width: 100%;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
        }
        
        .upload-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .file-input:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .disabled-message {
            color: #666;
            font-size: 13px;
            margin-top: 10px;
            font-style: italic;
        }
        
        .upload-status {
            margin-top: 10px;
            font-size: 13px;
            color: #666;
        }

        @media (max-width: 768px) {
            .container {
                width: 95%;
                height: 90vh;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 200px;
                border-right: none;
                border-bottom: 1px solid #e9ecef;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Excel Smart Chatbot</h1>
            <div class="status" id="status">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <div class="file-info" id="fileInfo">
                    <h3>üìä –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ñ–∞–π–ª</h3>
                    <div class="file-info-content">
                        <p>–§–∞–π–ª –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ</p>
                    </div>
                    <div class="file-upload">
                        <div id="changeFileSection">
                            <form id="uploadForm" enctype="multipart/form-data">
                                <input type="file" id="excelFile" accept=".xlsx, .xls" class="file-input" {% if not allow_change_file %}disabled{% endif %}>
                                <button type="button" id="uploadBtn" class="upload-btn" {% if not allow_change_file %}disabled{% endif %}>–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤–∏–π —Ñ–∞–π–ª</button>
                            </form>
                            <button type="button" id="useDefaultBtn" class="upload-btn" style="margin-top: 10px; background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);" {% if not allow_change_file %}disabled{% endif %}>–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ñ–∞–π–ª ({{ default_file }})</button>
                            {% if not allow_change_file %}
                            <p id="changeFileDisabledMsg" class="disabled-message" style="display: block;">–ó–º—ñ–Ω–∞ —Ñ–∞–π–ª—É –≤—ñ–¥–∫–ª—é—á–µ–Ω–∞.</p>
                            {% else %}
                            <p id="changeFileDisabledMsg" class="disabled-message" style="display: none;">–ó–º—ñ–Ω–∞ —Ñ–∞–π–ª—É –≤—ñ–¥–∫–ª—é—á–µ–Ω–∞.</p>
                            {% endif %}
                        </div>
                        
                        <div id="newChatSection">
                            <button type="button" id="newChatBtn" class="upload-btn" style="margin-top: 10px; background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);" {% if not allow_new_chat %}disabled{% endif %}>–ü–æ—á–∞—Ç–∏ –Ω–æ–≤–∏–π —á–∞—Ç</button>
                            {% if not allow_new_chat %}
                            <p id="newChatDisabledMsg" class="disabled-message" style="display: block;">–ù–æ–≤–∏–π —á–∞—Ç –≤—ñ–¥–∫–ª—é—á–µ–Ω–∏–π.</p>
                            {% else %}
                            <p id="newChatDisabledMsg" class="disabled-message" style="display: none;">–ù–æ–≤–∏–π —á–∞—Ç –≤—ñ–¥–∫–ª—é—á–µ–Ω–∏–π.</p>
                            {% endif %}
                        </div>
                        
                        <div style="margin-top: 20px; border-top: 1px solid #e9ecef; padding-top: 15px;">
                            <h4 style="margin-bottom: 10px; font-size: 14px;">–ö–µ—Ä—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—è–º–∏:</h4>
                            <button type="button" id="toggleChangeFileBtn" class="upload-btn" style="margin-bottom: 10px; background: linear-gradient(135deg, #2196F3 0%, #0D47A1 100%);">
                                {% if allow_change_file %}–í—ñ–¥–∫–ª—é—á–∏—Ç–∏{% else %}–í–∫–ª—é—á–∏—Ç–∏{% endif %} –∑–º—ñ–Ω—É —Ñ–∞–π–ª—É
                            </button>
                            <button type="button" id="toggleNewChatBtn" class="upload-btn" style="background: linear-gradient(135deg, #2196F3 0%, #0D47A1 100%);">
                                {% if allow_new_chat %}–í—ñ–¥–∫–ª—é—á–∏—Ç–∏{% else %}–í–∫–ª—é—á–∏—Ç–∏{% endif %} –Ω–æ–≤–∏–π —á–∞—Ç
                            </button>
                        </div>
                        
                        <div id="uploadStatus" class="upload-status"></div>
                    </div>
                </div>
                
                <div class="regions-list" id="regionsList">
                    <h3>üèôÔ∏è –î–æ—Å—Ç—É–ø–Ω—ñ —Ä–µ–≥—ñ–æ–Ω–∏</h3>
                    <p>–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö</p>
                </div>
                
                <div class="examples" id="examples">
                    <h3>üí° –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤</h3>
                    <p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
                </div>
            </div>
            
            <div class="chat-area">
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot">
                        <div class="message-content">
                            –ü—Ä–∏–≤—ñ—Ç! –Ø —É–º–Ω–∏–π —á–∞—Ç-–±–æ—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ Excel —Ñ–∞–π–ª–∞–º–∏. 
                            –Ø –º–æ–∂—É –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ, –ø–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ —Ä–µ–≥—ñ–æ–Ω–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –≤–∞—à—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è.
                            –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ñ–∞–π–ª –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π Excel —Ñ–∞–π–ª 
                            —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –≤ –±—ñ—á–Ω—ñ–π –ø–∞–Ω–µ–ª—ñ. –ü—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É —è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ 
                            –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É—é –π–æ–≥–æ —Ç–∞ –ø—ñ–¥–≥–æ—Ç—É—é—Å—å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –≤–∞—à—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è.
                        </div>
                    </div>
                </div>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>–û–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—É...</p>
                </div>
                
                <div class="chat-input">
                    <div class="input-group">
                        <input type="text" id="messageInput" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à –∑–∞–ø–∏—Ç..." disabled>
                        <button class="send-btn" id="sendBtn" disabled>–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let chatbotInitialized = false;
        // Store the default file path from the server
        const defaultFilePath = '{{ default_file }}';
        
        // –ï–ª–µ–º–µ–Ω—Ç–∏ DOM
        const statusEl = document.getElementById('status');
        const fileInfoEl = document.getElementById('fileInfo');
        const regionsListEl = document.getElementById('regionsList');
        const examplesEl = document.getElementById('examples');
        const chatMessagesEl = document.getElementById('chatMessages');
        const messageInputEl = document.getElementById('messageInput');
        const sendBtnEl = document.getElementById('sendBtn');
        const loadingEl = document.getElementById('loading');
        const toggleChangeFileBtnEl = document.getElementById('toggleChangeFileBtn');
        const toggleNewChatBtnEl = document.getElementById('toggleNewChatBtn');
        const changeFileSectionEl = document.getElementById('changeFileSection');
        const newChatSectionEl = document.getElementById('newChatSection');
        const excelFileEl = document.getElementById('excelFile');
        const uploadBtnEl = document.getElementById('uploadBtn');
        const uploadStatusEl = document.getElementById('uploadStatus');
        
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Ç-–±–æ—Ç–∞
        async function initChatbot() {
            try {
                statusEl.textContent = '–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Ç-–±–æ—Ç–∞...';
                
                const response = await fetch('/init', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        file_path: defaultFilePath
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    chatbotInitialized = true;
                    statusEl.textContent = '–ß–∞—Ç-–±–æ—Ç –≥–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–±–æ—Ç–∏';
                    updateFileInfo(data.file_info);
                    enableChat();
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —á–∞—Ç
                    let techInfoMessage = '–ß—É–¥–æ–≤–æ! –§–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ. –¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –¥–∞–Ω—ñ –ø–æ —Ä–µ–≥—ñ–æ–Ω–∞—Ö.<br><br>';
                    techInfoMessage += 'üìä <strong>–°–í–û–î–ö–ê –§–ê–ô–õ–ê:</strong><br>';
                    if (data.file_summary) {
                        techInfoMessage += data.file_summary + '<br><br>';
                    }
                    techInfoMessage += '‚ÑπÔ∏è <strong>–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:</strong><br>';
                    techInfoMessage += `- –õ–∏—Å—Ç–æ–≤: ${data.file_info.total_sheets}<br>`;
                    techInfoMessage += `- –õ–∏—Å—Ç—ã: ${data.file_info.sheets.join(', ')}`;
                    
                    addMessage('bot', techInfoMessage);
                } else {
                    throw new Error(data.message);
                }
            } catch (error) {
                statusEl.textContent = '–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó';
                addMessage('bot', `–ü–æ–º–∏–ª–∫–∞: ${error.message}`);
            }
        }
        
        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ñ–∞–π–ª
        function updateFileInfo(info) {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ, –Ω–µ —Ç—Ä–æ–≥–∞—è –∫–Ω–æ–ø–∫–∏
            const fileInfoContent = fileInfoEl.querySelector('.file-info-content');
            if (fileInfoContent) {
                fileInfoContent.innerHTML = `
                    <p><strong>–§–∞–π–ª:</strong> ${info.file_path}</p>
                    <p><strong>–õ–∏—Å—Ç—ñ–≤:</strong> ${info.total_sheets}</p>
                    <p><strong>–†–µ–≥—ñ–æ–Ω–∏:</strong> ${info.sheets.length}</p>
                `;
            }
            
            regionsListEl.innerHTML = `
                <h3>üèôÔ∏è –î–æ—Å—Ç—É–ø–Ω—ñ —Ä–µ–≥—ñ–æ–Ω–∏</h3>
                ${info.sheets.map(region => `<div class="region-item">${region}</div>`).join('')}
            `;
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏–∫–ª–∞–¥—ñ–≤
        async function loadExamples() {
            try {
                const response = await fetch('/examples');
                const data = await response.json();
                
                if (data.success) {
                    examplesEl.innerHTML = `
                        <h3>üí° –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤</h3>
                        ${data.examples.map(example => 
                            `<div class="example-item" onclick="useExample('${example}')">${example}</div>`
                        ).join('')}
                    `;
                }
            } catch (error) {
                examplesEl.innerHTML = '<h3>üí° –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤</h3><p>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</p>';
            }
        }
        
        // –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–∏–∫–ª–∞–¥—É
        function useExample(example) {
            if (chatbotInitialized) {
                messageInputEl.value = example;
                sendMessage();
            }
        }
        
        // –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —á–∞—Ç—É
        function enableChat() {
            messageInputEl.disabled = false;
            sendBtnEl.disabled = false;
            messageInputEl.focus();
        }
        
        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
        function addMessage(type, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const time = new Date().toLocaleTimeString('uk-UA', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            messageDiv.innerHTML = `
                <div class="message-content">
                    ${content}
                    <div class="message-time">${time}</div>
                </div>
            `;
            
            chatMessagesEl.appendChild(messageDiv);
            chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
        }
        
        // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
        async function sendMessage() {
            const message = messageInputEl.value.trim();
            if (!message || !chatbotInitialized) return;
            
            // –î–æ–¥–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
            addMessage('user', message);
            messageInputEl.value = '';
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            loadingEl.classList.add('show');
            
            try {
                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ query: message })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    addMessage('bot', data.response);
                } else {
                    addMessage('bot', `–ü–æ–º–∏–ª–∫–∞: ${data.message}`);
                }
            } catch (error) {
                addMessage('bot', `–ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è: ${error.message}`);
            } finally {
                loadingEl.classList.remove('show');
            }
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É
        async function uploadFile() {
            const fileInput = excelFileEl;
            if (!fileInput.files || fileInput.files.length === 0) {
                uploadStatusEl.textContent = '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è';
                addMessage('bot', '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è');
                return;
            }
            
            const file = fileInput.files[0];
            if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
                uploadStatusEl.textContent = '–ü—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —Ñ–∞–π–ª–∏ Excel (.xlsx –∞–±–æ .xls)';
                addMessage('bot', '–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∏–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª Excel (.xlsx –∞–±–æ .xls)');
                return;
            }
            
            // –°—Ç–≤–æ—Ä—é—î–º–æ FormData
            const formData = new FormData();
            formData.append('file', file);
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            loadingEl.classList.add('show');
            statusEl.textContent = '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É...';
            uploadStatusEl.textContent = `–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É ${file.name}...`;
            uploadBtnEl.disabled = true;
            
            try {
                // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–∞–π–ª
                uploadStatusEl.textContent = '–ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä...';
                const uploadResponse = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });
                
                const uploadData = await uploadResponse.json();
                
                if (uploadData.success) {
                    statusEl.textContent = '–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Ç-–±–æ—Ç–∞ –∑ –Ω–æ–≤–∏–º —Ñ–∞–π–ª–æ–º...';
                    uploadStatusEl.textContent = '–§–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Ç-–±–æ—Ç–∞...';
                    addMessage('bot', `–§–∞–π–ª ${file.name} —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Ç-–±–æ—Ç–∞...`);
                    
                    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ —á–∞—Ç-–±–æ—Ç–∞ –∑ –Ω–æ–≤–∏–º —Ñ–∞–π–ª–æ–º
                    uploadStatusEl.textContent = '–ê–Ω–∞–ª—ñ–∑ –¥–∞–Ω–∏—Ö —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª—ñ...';
                    const initResponse = await fetch('/init', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            file_path: uploadData.file_path
                        })
                    });
                    
                    const initData = await initResponse.json();
                    
                    if (initData.success) {
                        chatbotInitialized = true;
                        statusEl.textContent = '–ß–∞—Ç-–±–æ—Ç –≥–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–±–æ—Ç–∏';
                        uploadStatusEl.textContent = '–§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ –æ–±—Ä–æ–±–ª–µ–Ω–æ!';
                        updateFileInfo(initData.file_info);
                        enableChat();
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —á–∞—Ç
                        let techInfoMessage = '–ß—É–¥–æ–≤–æ! –ù–æ–≤–∏–π —Ñ–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —Ç–∞ –æ–±—Ä–æ–±–ª–µ–Ω–æ. –¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –¥–∞–Ω—ñ –ø–æ —Ä–µ–≥—ñ–æ–Ω–∞—Ö.<br><br>';
                        techInfoMessage += 'üìä <strong>–°–í–û–î–ö–ê –§–ê–ô–õ–ê:</strong><br>';
                        if (initData.file_summary) {
                            techInfoMessage += initData.file_summary + '<br><br>';
                        }
                        techInfoMessage += '‚ÑπÔ∏è <strong>–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:</strong><br>';
                        techInfoMessage += `- –õ–∏—Å—Ç–æ–≤: ${initData.file_info.total_sheets}<br>`;
                        techInfoMessage += `- –õ–∏—Å—Ç—ã: ${initData.file_info.sheets.join(', ')}`;
                        
                        addMessage('bot', techInfoMessage);
                        
                        // –û—á–∏—â–∞—î–º–æ –ø–æ–ª–µ –≤–∏–±–æ—Ä—É —Ñ–∞–π–ª—É
                        fileInput.value = '';
                        
                        // –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ —Å—Ç–∞—Ç—É—Å
                        setTimeout(() => {
                            uploadStatusEl.textContent = '';
                        }, 5000);
                    } else {
                        throw new Error(initData.message);
                    }
                } else {
                    throw new Error(uploadData.message);
                }
            } catch (error) {
                statusEl.textContent = '–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è';
                uploadStatusEl.textContent = `–ü–æ–º–∏–ª–∫–∞: ${error.message}`;
                addMessage('bot', `–ü–æ–º–∏–ª–∫–∞: ${error.message}`);
            } finally {
                loadingEl.classList.remove('show');
                uploadBtnEl.disabled = false;
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        async function useDefaultFile() {
            // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            loadingEl.classList.add('show');
            statusEl.textContent = '–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Ç-–±–æ—Ç–∞ –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–º —Ñ–∞–π–ª–æ–º...';
            uploadStatusEl.textContent = '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª—É...';
            
            try {
                const response = await fetch('/init', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        file_path: defaultFilePath
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    chatbotInitialized = true;
                    statusEl.textContent = '–ß–∞—Ç-–±–æ—Ç –≥–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–±–æ—Ç–∏';
                    uploadStatusEl.textContent = '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ñ–∞–π–ª —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!';
                    updateFileInfo(data.file_info);
                    enableChat();
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —á–∞—Ç
                    let techInfoMessage = '–ß—É–¥–æ–≤–æ! –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —Ñ–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ. –¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ –¥–∞–Ω—ñ –ø–æ —Ä–µ–≥—ñ–æ–Ω–∞—Ö.<br><br>';
                    techInfoMessage += 'üìä <strong>–°–í–û–î–ö–ê –§–ê–ô–õ–ê:</strong><br>';
                    if (data.file_summary) {
                        techInfoMessage += data.file_summary + '<br><br>';
                    }
                    techInfoMessage += '‚ÑπÔ∏è <strong>–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:</strong><br>';
                    techInfoMessage += `- –õ–∏—Å—Ç–æ–≤: ${data.file_info.total_sheets}<br>`;
                    techInfoMessage += `- –õ–∏—Å—Ç—ã: ${data.file_info.sheets.join(', ')}`;
                    
                    addMessage('bot', techInfoMessage);
                    
                    // –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ —Å—Ç–∞—Ç—É—Å
                    setTimeout(() => {
                        uploadStatusEl.textContent = '';
                    }, 5000);
                } else {
                    throw new Error(data.message);
                }
            } catch (error) {
                statusEl.textContent = '–ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó';
                uploadStatusEl.textContent = `–ü–æ–º–∏–ª–∫–∞: ${error.message}`;
                addMessage('bot', `–ü–æ–º–∏–ª–∫–∞: ${error.message}`);
            } finally {
                loadingEl.classList.remove('show');
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ—á–∞—Ç–∫—É –Ω–æ–≤–æ–≥–æ —á–∞—Ç—É (—Ä–µ—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–æ–¥–µ–ª—ñ)
        async function startNewChat() {
            if (!chatbotInitialized) {
                uploadStatusEl.textContent = '–°–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–∞—Ç-–±–æ—Ç';
                addMessage('bot', '–°–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª');
                return;
            }
            
            // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            loadingEl.classList.add('show');
            statusEl.textContent = '–†–µ—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —á–∞—Ç-–±–æ—Ç–∞...';
            uploadStatusEl.textContent = '–ü–æ—á–∞—Ç–æ–∫ –Ω–æ–≤–æ–≥–æ —á–∞—Ç—É...';
            
            try {
                const response = await fetch('/reinit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    statusEl.textContent = '–ß–∞—Ç-–±–æ—Ç –≥–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–±–æ—Ç–∏';
                    uploadStatusEl.textContent = '–ù–æ–≤–∏–π —á–∞—Ç —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑–ø–æ—á–∞—Ç–æ!';
                    
                    // –û—á–∏—â–∞—î–º–æ —ñ—Å—Ç–æ—Ä—ñ—é —á–∞—Ç—É
                    chatMessagesEl.innerHTML = '';
                    
                    // –î–æ–¥–∞—î–º–æ –ø–æ—á–∞—Ç–∫–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                    addMessage('bot', '–ù–æ–≤–∏–π —á–∞—Ç —Ä–æ–∑–ø–æ—á–∞—Ç–æ. –Ü—Å—Ç–æ—Ä—ñ—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –æ—á–∏—â–µ–Ω–∞. –í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è.');
                    
                    // –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ —Å—Ç–∞—Ç—É—Å
                    setTimeout(() => {
                        uploadStatusEl.textContent = '';
                    }, 5000);
                } else {
                    throw new Error(data.message);
                }
            } catch (error) {
                statusEl.textContent = '–ü–æ–º–∏–ª–∫–∞ —Ä–µ—ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó';
                uploadStatusEl.textContent = `–ü–æ–º–∏–ª–∫–∞: ${error.message}`;
                addMessage('bot', `–ü–æ–º–∏–ª–∫–∞: ${error.message}`);
            } finally {
                loadingEl.classList.remove('show');
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –∑–º—ñ–Ω–∏ —Ñ–∞–π–ª—É
        async function toggleChangeFile() {
            // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            loadingEl.classList.add('show');
            statusEl.textContent = '–ó–º—ñ–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å...';
            
            try {
                const response = await fetch('/toggle-change-file', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    statusEl.textContent = '–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–µ–Ω–æ';
                    uploadStatusEl.textContent = data.message;
                    
                    // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    if (data.enabled) {
                        // –§—É–Ω–∫—Ü—ñ—è –≤–∫–ª—é—á–µ–Ω–∞
                        const excelFileEl = document.getElementById('excelFile');
                        const uploadBtnEl = document.getElementById('uploadBtn');
                        const useDefaultBtnEl = document.getElementById('useDefaultBtn');
                        const disabledMsgEl = document.getElementById('changeFileDisabledMsg');
                        
                        if (excelFileEl) excelFileEl.disabled = false;
                        if (uploadBtnEl) uploadBtnEl.disabled = false;
                        if (useDefaultBtnEl) useDefaultBtnEl.disabled = false;
                        if (disabledMsgEl) disabledMsgEl.style.display = 'none';
                        
                        toggleChangeFileBtnEl.textContent = '–í—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∑–º—ñ–Ω—É —Ñ–∞–π–ª—É';
                    } else {
                        // –§—É–Ω–∫—Ü—ñ—è –≤—ñ–¥–∫–ª—é—á–µ–Ω–∞
                        const excelFileEl = document.getElementById('excelFile');
                        const uploadBtnEl = document.getElementById('uploadBtn');
                        const useDefaultBtnEl = document.getElementById('useDefaultBtn');
                        const disabledMsgEl = document.getElementById('changeFileDisabledMsg');
                        
                        if (excelFileEl) excelFileEl.disabled = true;
                        if (uploadBtnEl) uploadBtnEl.disabled = true;
                        if (useDefaultBtnEl) useDefaultBtnEl.disabled = true;
                        if (disabledMsgEl) disabledMsgEl.style.display = 'block';
                        
                        toggleChangeFileBtnEl.textContent = '–í–∫–ª—é—á–∏—Ç–∏ –∑–º—ñ–Ω—É —Ñ–∞–π–ª—É';
                    }
                    
                    // –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ —Å—Ç–∞—Ç—É—Å
                    setTimeout(() => {
                        uploadStatusEl.textContent = '';
                    }, 5000);
                } else {
                    throw new Error(data.message);
                }
            } catch (error) {
                statusEl.textContent = '–ü–æ–º–∏–ª–∫–∞ –∑–º—ñ–Ω–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å';
                uploadStatusEl.textContent = `–ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            } finally {
                loadingEl.classList.remove('show');
            }
        }
        
        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–æ–≤–æ–≥–æ —á–∞—Ç—É
        async function toggleNewChat() {
            // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
            loadingEl.classList.add('show');
            statusEl.textContent = '–ó–º—ñ–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å...';
            
            try {
                const response = await fetch('/toggle-new-chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    statusEl.textContent = '–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–µ–Ω–æ';
                    uploadStatusEl.textContent = data.message;
                    
                    // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    if (data.enabled) {
                        // –§—É–Ω–∫—Ü—ñ—è –≤–∫–ª—é—á–µ–Ω–∞
                        const newChatBtnEl = document.getElementById('newChatBtn');
                        const disabledMsgEl = document.getElementById('newChatDisabledMsg');
                        
                        if (newChatBtnEl) newChatBtnEl.disabled = false;
                        if (disabledMsgEl) disabledMsgEl.style.display = 'none';
                        
                        toggleNewChatBtnEl.textContent = '–í—ñ–¥–∫–ª—é—á–∏—Ç–∏ –Ω–æ–≤–∏–π —á–∞—Ç';
                    } else {
                        // –§—É–Ω–∫—Ü—ñ—è –≤—ñ–¥–∫–ª—é—á–µ–Ω–∞
                        const newChatBtnEl = document.getElementById('newChatBtn');
                        const disabledMsgEl = document.getElementById('newChatDisabledMsg');
                        
                        if (newChatBtnEl) newChatBtnEl.disabled = true;
                        if (disabledMsgEl) disabledMsgEl.style.display = 'block';
                        
                        toggleNewChatBtnEl.textContent = '–í–∫–ª—é—á–∏—Ç–∏ –Ω–æ–≤–∏–π —á–∞—Ç';
                    }
                    
                    // –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏–±–∏—Ä–∞—î–º–æ —Å—Ç–∞—Ç—É—Å
                    setTimeout(() => {
                        uploadStatusEl.textContent = '';
                    }, 5000);
                } else {
                    throw new Error(data.message);
                }
            } catch (error) {
                statusEl.textContent = '–ü–æ–º–∏–ª–∫–∞ –∑–º—ñ–Ω–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å';
                uploadStatusEl.textContent = `–ü–æ–º–∏–ª–∫–∞: ${error.message}`;
            } finally {
                loadingEl.classList.remove('show');
            }
        }

        // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
        sendBtnEl.addEventListener('click', sendMessage);
        
        messageInputEl.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        uploadBtnEl.addEventListener('click', uploadFile);
        
        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        document.getElementById('useDefaultBtn').addEventListener('click', useDefaultFile);
        
        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –Ω–æ–≤–æ–≥–æ —á–∞—Ç—É
        document.getElementById('newChatBtn').addEventListener('click', startNewChat);
        
        // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π
        toggleChangeFileBtnEl.addEventListener('click', toggleChangeFile);
        toggleNewChatBtnEl.addEventListener('click', toggleNewChat);
        
        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
        document.addEventListener('DOMContentLoaded', () => {
            loadExamples();
            initChatbot();
        });
    </script>
</body>
</html> 